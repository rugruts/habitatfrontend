var Fe=Object.defineProperty;var Me=(r,s,a)=>s in r?Fe(r,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[s]=a;var te=(r,s,a)=>Me(r,typeof s!="symbol"?s+"":s,a);import{aq as Oe,s as V,ar as ce,r as d,as as X,j as e,at as T,au as W,av as Ge,aw as $e,ax as Te,ay as le,az as Le,aA as qe,aB as He,aC as Ue,c as I,aD as Ve,u as We,R as de,aE as $,m as Ke,C as v,v as A,w as R,x as Z,i as k,aF as E,aj as me,aG as Q,aH as Ye,aI as O,aJ as ze,aK as Je,aL as _,aM as Xe,aN as Ze,aO as Qe,aP as es,B as S,ak as ne,a3 as ss,K as ee,an as K,aQ as B,z as Y,y as z,aR as re,aS as q,aT as M,O as G,P as xe,aU as as,aV as ts,aW as ns,aX as rs,aY as is,aZ as os,a_ as cs,a$ as ls,a8 as ds,H as ms,b0 as xs,b1 as hs,b2 as ps,t as us,b3 as gs,S as ie,A as oe,b4 as fs,b5 as ys,b6 as js,b7 as bs,b8 as Ns,b9 as vs,ba as ks}from"./index-D-p4FLLa.js";import{S as ws,K as Cs}from"./smartphone-CTXg5kv-.js";import{E as J}from"./euro-xw47IFvc.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=Oe("Apple",[["path",{d:"M12 20.94c1.5 0 2.75 1.06 4 1.06 3 0 6-8 6-12.22A4.91 4.91 0 0 0 17 5c-2.22 0-4 1.44-5 2-1-.56-2.78-2-5-2a4.9 4.9 0 0 0-5 4.78C2 14 5 22 8 22c1.25 0 2.5-1.06 4-1.06Z",key:"3s7exb"}],["path",{d:"M10 2c1 .5 2 2 2 5",key:"fcco2y"}]]);class Ps{constructor(){te(this,"API_BASE_URL","https://backendhabitatapi.vercel.app/api")}createBookingConfirmationEmail(s){const a=new Date(s.checkIn).toLocaleDateString("en-GB"),t=new Date(s.checkOut).toLocaleDateString("en-GB"),n=Math.ceil((new Date(s.checkOut).getTime()-new Date(s.checkIn).getTime())/(1e3*60*60*24)),i=`Booking Confirmed - ${s.propertyName} | Habitat Lobby`,o=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Booking Confirmation</title>
        <style>
          body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; margin: 0; padding: 0; }
          .container { max-width: 600px; margin: 0 auto; padding: 20px; }
          .header { background: #2D5A27; color: white; padding: 30px 20px; text-align: center; border-radius: 8px 8px 0 0; }
          .content { padding: 30px 20px; background: #ffffff; }
          .booking-details { background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; }
          .detail-row { display: flex; justify-content: space-between; margin: 10px 0; padding: 5px 0; border-bottom: 1px solid #eee; }
          .detail-row:last-child { border-bottom: none; }
          .footer { background: #f8f9fa; padding: 20px; text-align: center; font-size: 14px; color: #666; border-radius: 0 0 8px 8px; }
          .button { background: #D4A574; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block; margin: 20px 0; }
          .highlight { background: #e8f5e8; padding: 15px; border-radius: 6px; margin: 15px 0; border-left: 4px solid #2D5A27; }
        </style>
      </head>
      <body>
        <div class="container">
          <div class="header">
            <h1>ðŸŽ‰ Booking Confirmed!</h1>
            <p>Thank you for choosing Habitat Lobby</p>
          </div>
          
          <div class="content">
            <p>Dear ${s.guestName},</p>
            
            <p>We're delighted to confirm your reservation. Your booking details are below:</p>
            
            <div class="booking-details">
              <h3 style="margin-top: 0; color: #2D5A27;">Booking Reference: ${s.bookingId}</h3>
              <div class="detail-row">
                <span><strong>Property:</strong></span>
                <span>${s.propertyName}</span>
              </div>
              <div class="detail-row">
                <span><strong>Check-in:</strong></span>
                <span>${a} (15:00)</span>
              </div>
              <div class="detail-row">
                <span><strong>Check-out:</strong></span>
                <span>${t} (11:00)</span>
              </div>
              <div class="detail-row">
                <span><strong>Duration:</strong></span>
                <span>${n} night${n>1?"s":""}</span>
              </div>
              <div class="detail-row">
                <span><strong>Guests:</strong></span>
                <span>${s.guests}</span>
              </div>
              <div class="detail-row">
                <span><strong>Total Amount:</strong></span>
                <span><strong>â‚¬${s.totalAmount.toFixed(2)}</strong></span>
              </div>
            </div>
            
            ${s.specialRequests?`
            <div class="booking-details">
              <h4 style="margin-top: 0; color: #2D5A27;">Special Requests:</h4>
              <p style="margin-bottom: 0;">${s.specialRequests}</p>
            </div>
            `:""}
            
            <div class="highlight">
              <h3 style="margin-top: 0;">ðŸ“‹ What's Next?</h3>
              <ul style="margin-bottom: 0;">
                <li>You'll receive check-in instructions 48 hours before arrival</li>
                <li>Free cancellation up to 48 hours before check-in</li>
                <li>Our local team is available 24/7 for assistance</li>
                <li>Please bring the same ID document used during booking</li>
              </ul>
            </div>
            
            <div style="text-align: center; margin: 30px 0;">
              <a href="https://habitatlobby.com/view-booking/${s.bookingId}" class="button">
                View Booking Details
              </a>
            </div>
            
            <p>We look forward to hosting you in beautiful Trikala!</p>
            
            <p>Best regards,<br>
            <strong>The Habitat Lobby Team</strong></p>
          </div>
          
          <div class="footer">
            <p><strong>Habitat Lobby</strong> | Trikala, Greece</p>
            <p>For support, contact us at <a href="mailto:hello@habitatlobby.com">hello@habitatlobby.com</a></p>
            <p style="font-size: 12px; color: #999; margin-top: 15px;">
              This email was sent regarding your booking ${s.bookingId}. 
              Please keep this email for your records.
            </p>
          </div>
        </div>
      </body>
      </html>
    `,u=`
      Booking Confirmed - Habitat Lobby
      
      Dear ${s.guestName},
      
      We're delighted to confirm your reservation.
      
      Booking Reference: ${s.bookingId}
      Property: ${s.propertyName}
      Check-in: ${a} (15:00)
      Check-out: ${t} (11:00)
      Duration: ${n} night${n>1?"s":""}
      Guests: ${s.guests}
      Total Amount: â‚¬${s.totalAmount.toFixed(2)}
      
      ${s.specialRequests?`Special Requests: ${s.specialRequests}

`:""}
      
      What's Next?
      - You'll receive check-in instructions 48 hours before arrival
      - Free cancellation up to 48 hours before check-in
      - Our local team is available 24/7 for assistance
      - Please bring the same ID document used during booking
      
      View your booking: https://habitatlobby.com/view-booking/${s.bookingId}
      
      We look forward to hosting you in beautiful Trikala!
      
      Best regards,
      The Habitat Lobby Team
      
      Habitat Lobby | Trikala, Greece
      For support, contact us at hello@habitatlobby.com
    `;return{subject:i,html:o,text:u}}async sendBookingConfirmation(s){try{const a=this.createBookingConfirmationEmail(s);console.log("ðŸ“§ Sending booking confirmation email to:",s.guestEmail),console.log("ðŸ“§ Email subject:",a.subject);const t=await fetch(`${this.API_BASE_URL}/booking-confirmation`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":"habitat_lobby_2024_86abfb60f093d26335ebc1f3b028f254"},body:JSON.stringify({bookingId:s.bookingId})});if(!t.ok){const i=await t.json().catch(()=>({}));throw new Error(`Email API error: ${t.status} - ${i.error||"Unknown error"}`)}const n=await t.json();return console.log("âœ… Email sent successfully via API:",n),console.log("âœ… Booking confirmation email sent successfully"),!0}catch(a){return console.error("âŒ Failed to send booking confirmation email:",a),!1}}async sendBookingConfirmationById(s){var a;try{const t=await V.getAllBookings(1,0,{booking_id:s});if(!t.bookings||t.bookings.length===0)return console.error("Booking not found:",s),!1;const n=t.bookings[0],i={bookingId:n.id,guestName:n.customer_name,guestEmail:n.customer_email,propertyName:((a=n.properties)==null?void 0:a.name)||"Property",checkIn:n.check_in,checkOut:n.check_out,guests:n.guests,totalAmount:n.total_amount,currency:n.currency||"EUR",specialRequests:n.special_requests};return await this.sendBookingConfirmation(i)}catch(t){return console.error("Failed to send booking confirmation by ID:",t),!1}}}const H=new Ps;var se="Radio",[Es,he]=ce(se),[As,Rs]=Es(se),pe=d.forwardRef((r,s)=>{const{__scopeRadio:a,name:t,checked:n=!1,required:i,disabled:o,value:u="on",onCheck:m,form:f,...h}=r,[c,x]=d.useState(null),p=X(s,j=>x(j)),y=d.useRef(!1),w=c?f||!!c.closest("form"):!0;return e.jsxs(As,{scope:a,checked:n,disabled:o,children:[e.jsx(T.button,{type:"button",role:"radio","aria-checked":n,"data-state":ye(n),"data-disabled":o?"":void 0,disabled:o,value:u,...h,ref:p,onClick:W(r.onClick,j=>{n||m==null||m(),w&&(y.current=j.isPropagationStopped(),y.current||j.stopPropagation())})}),w&&e.jsx(fe,{control:c,bubbles:!y.current,name:t,value:u,checked:n,required:i,disabled:o,form:f,style:{transform:"translateX(-100%)"}})]})});pe.displayName=se;var ue="RadioIndicator",ge=d.forwardRef((r,s)=>{const{__scopeRadio:a,forceMount:t,...n}=r,i=Rs(ue,a);return e.jsx(Ge,{present:t||i.checked,children:e.jsx(T.span,{"data-state":ye(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:s})})});ge.displayName=ue;var _s="RadioBubbleInput",fe=d.forwardRef(({__scopeRadio:r,control:s,checked:a,bubbles:t=!0,...n},i)=>{const o=d.useRef(null),u=X(o,i),m=$e(a),f=Te(s);return d.useEffect(()=>{const h=o.current;if(!h)return;const c=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(c,"checked").set;if(m!==a&&p){const y=new Event("click",{bubbles:t});p.call(h,a),h.dispatchEvent(y)}},[m,a,t]),e.jsx(T.input,{type:"radio","aria-hidden":!0,defaultChecked:a,...n,tabIndex:-1,ref:u,style:{...n.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});fe.displayName=_s;function ye(r){return r?"checked":"unchecked"}var Is=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],L="RadioGroup",[Bs,Js]=ce(L,[le,he]),je=le(),be=he(),[Ds,Fs]=Bs(L),Ne=d.forwardRef((r,s)=>{const{__scopeRadioGroup:a,name:t,defaultValue:n,value:i,required:o=!1,disabled:u=!1,orientation:m,dir:f,loop:h=!0,onValueChange:c,...x}=r,p=je(a),y=Le(f),[w,j]=qe({prop:i,defaultProp:n??null,onChange:c,caller:L});return e.jsx(Ds,{scope:a,name:t,required:o,disabled:u,value:w,onValueChange:j,children:e.jsx(He,{asChild:!0,...p,orientation:m,dir:y,loop:h,children:e.jsx(T.div,{role:"radiogroup","aria-required":o,"aria-orientation":m,"data-disabled":u?"":void 0,dir:y,...x,ref:s})})})});Ne.displayName=L;var ve="RadioGroupItem",ke=d.forwardRef((r,s)=>{const{__scopeRadioGroup:a,disabled:t,...n}=r,i=Fs(ve,a),o=i.disabled||t,u=je(a),m=be(a),f=d.useRef(null),h=X(s,f),c=i.value===n.value,x=d.useRef(!1);return d.useEffect(()=>{const p=w=>{Is.includes(w.key)&&(x.current=!0)},y=()=>x.current=!1;return document.addEventListener("keydown",p),document.addEventListener("keyup",y),()=>{document.removeEventListener("keydown",p),document.removeEventListener("keyup",y)}},[]),e.jsx(Ue,{asChild:!0,...u,focusable:!o,active:c,children:e.jsx(pe,{disabled:o,required:i.required,checked:c,...m,...n,name:i.name,ref:h,onCheck:()=>i.onValueChange(n.value),onKeyDown:W(p=>{p.key==="Enter"&&p.preventDefault()}),onFocus:W(n.onFocus,()=>{var p;x.current&&((p=f.current)==null||p.click())})})})});ke.displayName=ve;var Ms="RadioGroupIndicator",we=d.forwardRef((r,s)=>{const{__scopeRadioGroup:a,...t}=r,n=be(a);return e.jsx(ge,{...n,...t,ref:s})});we.displayName=Ms;var Ce=Ne,Se=ke,Os=we;const Pe=d.forwardRef(({className:r,...s},a)=>e.jsx(Ce,{className:I("grid gap-2",r),...s,ref:a}));Pe.displayName=Ce.displayName;const Ee=d.forwardRef(({className:r,...s},a)=>e.jsx(Se,{ref:a,className:I("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...s,children:e.jsx(Os,{className:"flex items-center justify-center",children:e.jsx(Ve,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Ee.displayName=Se.displayName;const Gs=({selectedMethod:r,onMethodChange:s,amount:a,currency:t,className:n})=>{const{t:i}=We(),[o,u]=d.useState(!1),[m,f]=d.useState(!1);de.useEffect(()=>{window.ApplePaySession&&ApplePaySession.canMakePayments()&&u(!0),window.google&&window.google.payments&&f(!0)},[]);const h=[{id:"card",name:i("payment.creditCard"),description:i("payment.creditCardDesc"),icon:$,available:!0,badge:null},{id:"apple_pay",name:"Apple Pay",description:i("payment.applePayDesc"),icon:Ss,available:o,badge:o?null:i("payment.notAvailable")},{id:"google_pay",name:"Google Pay",description:i("payment.googlePayDesc"),icon:ws,available:m,badge:m?null:i("payment.notAvailable")},{id:"sepa",name:"SEPA Direct Debit",description:i("payment.sepaDesc"),icon:Ke,available:!0,badge:null},{id:"cash_on_arrival",name:i("payment.cashOnArrival"),description:i("payment.cashOnArrivalDesc"),icon:J,available:!0,badge:i("payment.arrivalOnly")}];return e.jsxs(v,{className:n,children:[e.jsx(A,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-green-600"}),i("payment.selectMethod")]})}),e.jsxs(k,{children:[e.jsx(Pe,{value:r,onValueChange:c=>s(c),children:e.jsx("div",{className:"space-y-3",children:h.map(c=>{const x=c.icon;return e.jsxs("div",{className:"relative",children:[e.jsx(Ee,{value:c.id,id:c.id,className:"peer sr-only",disabled:!c.available}),e.jsx(E,{htmlFor:c.id,className:`flex items-center gap-3 p-4 border rounded-lg cursor-pointer transition-all duration-200 ${r===c.id?"border-primary bg-primary/5":"border-gray-200 hover:border-gray-300"} ${c.available?"":"opacity-50 cursor-not-allowed"}`,children:e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(x,{className:"h-6 w-6 text-gray-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:c.name}),c.badge&&e.jsx(me,{variant:"secondary",className:"text-xs",children:c.badge}),r===c.id&&e.jsx(Q,{className:"h-4 w-4 text-green-600"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:c.description})]})]})})]},c.id)})})}),e.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ye,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{className:"font-medium text-gray-800 mb-1",children:i("payment.securityTitle")}),e.jsx("p",{children:i("payment.securityDesc")})]})]})}),e.jsx("div",{className:"mt-4 p-4 bg-primary/5 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"font-medium",children:[i("payment.totalAmount"),":"]}),e.jsx("span",{className:"text-xl font-bold text-primary",children:new Intl.NumberFormat("el-GR",{style:"currency",currency:t}).format(a/100)})]})})]})]})};class $s{static async createCashOnArrivalBooking(s,a,t="EUR"){const{data:n,error:i}=await O.from("cash_on_arrival_bookings").insert({booking_id:s,amount:a/100,currency:t,status:"pending",payment_instructions:`Please pay â‚¬${(a/100).toFixed(2)} in cash upon arrival at the property.`}).select().single();if(i)throw console.error("Error creating cash on arrival booking:",i),new Error(`Failed to create cash on arrival booking: ${i.message}`);return n}static async getCashOnArrivalBooking(s){const{data:a,error:t}=await O.from("cash_on_arrival_bookings").select("*").eq("booking_id",s).single();if(t){if(t.code==="PGRST116")return null;throw console.error("Error fetching cash on arrival booking:",t),new Error(`Failed to fetch cash on arrival booking: ${t.message}`)}return a}static async updateCashOnArrivalStatus(s,a){const{data:t,error:n}=await O.from("cash_on_arrival_bookings").update({status:a}).eq("booking_id",s).select().single();if(n)throw console.error("Error updating cash on arrival status:",n),new Error(`Failed to update cash on arrival status: ${n.message}`);return t}static async markAsPaid(s){return this.updateCashOnArrivalStatus(s,"paid")}static async cancelCashOnArrival(s){return this.updateCashOnArrivalStatus(s,"cancelled")}}const Ts=({amount:r,currency:s,bookingDetails:a,customerDetails:t,onSuccess:n,onError:i})=>{const o=ze(),u=Je(),[m,f]=d.useState(!1),[h,c]=d.useState(""),[x,p]=d.useState("card");d.useState(!1);const y=async j=>{j.preventDefault(),f(!0),c("");try{if(x==="cash_on_arrival"){await w();return}if(!o||!u)throw new Error("Stripe not available");const{error:b,paymentIntent:P}=await o.confirmPayment({elements:u,confirmParams:{return_url:`${window.location.origin}/booking-confirmation`,payment_method_data:{billing_details:{name:(t==null?void 0:t.name)||"Guest",email:(t==null?void 0:t.email)||void 0}}},redirect:"if_required"});b?(c(b.message||"An unexpected error occurred."),i(b.message||"Payment failed")):P&&P.status==="succeeded"&&n(P)}catch(b){console.error("Payment error:",b),c("An unexpected error occurred during payment."),i("Payment failed")}finally{f(!1)}},w=async()=>{try{const j=await $s.createCashOnArrivalBooking(a.unitName,r,s),b={id:`cash_${Date.now()}`,status:"succeeded",amount:r,metadata:{booking_id:j.id,payment_method:"cash_on_arrival"}};n(b)}catch(j){console.error("Cash on arrival error:",j),c("Failed to process cash on arrival booking."),i("Cash on arrival booking failed")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(v,{className:"border-0 shadow-lg bg-gray-50",children:[e.jsx(A,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5 text-green-600"}),"Booking Summary"]})}),e.jsxs(k,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Accommodation:"}),e.jsx("span",{className:"text-sm font-medium",children:a.unitName})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Check-in:"}),e.jsx("span",{className:"text-sm font-medium",children:a.checkIn})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Check-out:"}),e.jsx("span",{className:"text-sm font-medium",children:a.checkOut})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Guests:"}),e.jsx("span",{className:"text-sm font-medium",children:a.guests})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Nights:"}),e.jsx("span",{className:"text-sm font-medium",children:a.nights})]}),e.jsx("div",{className:"border-t pt-3 mt-3",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Total Amount:"}),e.jsx("span",{className:"font-bold text-lg",children:_(r,s)})]})})]})]}),e.jsx(Gs,{selectedMethod:x,onMethodChange:p,amount:r,currency:s}),e.jsxs(v,{className:"border-0 shadow-lg",children:[e.jsx(A,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5 text-accent"}),"Payment Details"]})}),e.jsxs(k,{children:[x==="cash_on_arrival"&&e.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(J,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Cash on Arrival"}),e.jsx("p",{className:"text-sm text-blue-700 mb-3",children:"You can pay in cash when you arrive at the property. No payment is required now."}),e.jsxs("div",{className:"text-sm text-blue-600",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Amount to pay:"})," ",_(r,s)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Payment location:"})," At the property upon check-in"]})]})]})]})}),x!=="cash_on_arrival"&&e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Billing Address"}),e.jsx(Xe,{options:{mode:"billing",allowedCountries:["GR","US","GB","DE","FR","IT","ES"]}})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium mb-3",children:"Payment Method"}),e.jsx(Ze,{options:{layout:"tabs",wallets:{applePay:"auto",googlePay:"auto"}}})]}),h&&e.jsx(Qe,{variant:"destructive",children:e.jsx(es,{children:h})}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground bg-blue-50 p-3 rounded-lg",children:[e.jsx(Z,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{children:"Your payment information is secure and encrypted"})]}),e.jsx(S,{type:"submit",disabled:!o||m,className:"w-full h-12 text-lg font-semibold bg-accent hover:bg-accent/90",children:m?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5 animate-spin"}),"Processing Payment..."]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5"}),"Pay ",_(r,s)]})})]}),x==="cash_on_arrival"&&e.jsx(S,{onClick:y,disabled:m,className:"w-full h-12 text-lg font-semibold bg-green-600 hover:bg-green-700",children:m?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-5 w-5 animate-spin"}),"Processing Booking..."]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),"Confirm Cash on Arrival Booking"]})})]})]}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[e.jsx("p",{children:"We accept multiple payment methods for your convenience"}),e.jsxs("div",{className:"flex justify-center gap-3 mt-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 px-3 py-1 rounded-full",children:[e.jsx("span",{children:"ðŸ’³"}),e.jsx("span",{className:"text-xs",children:"Cards"})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 px-3 py-1 rounded-full",children:[e.jsx("span",{children:"ðŸŽ"}),e.jsx("span",{className:"text-xs",children:"Apple Pay"})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 px-3 py-1 rounded-full",children:[e.jsx("span",{children:"ðŸŸ¢"}),e.jsx("span",{className:"text-xs",children:"Google Pay"})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 px-3 py-1 rounded-full",children:[e.jsx("span",{children:"ðŸ…¿ï¸"}),e.jsx("span",{className:"text-xs",children:"PayPal"})]}),e.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 px-3 py-1 rounded-full",children:[e.jsx("span",{children:"ðŸ¦"}),e.jsx("span",{className:"text-xs",children:"Bank Transfer"})]})]}),e.jsx("p",{className:"text-xs mt-2 opacity-75",children:"Secure payments powered by Stripe"})]})]})},U=[{id:"details",label:"Guest Details",description:"Your information & ID verification"},{id:"payment",label:"Payment",description:"Secure checkout"},{id:"confirmation",label:"Confirmation",description:"Booking complete"}],Ls=({currentStep:r})=>{const s=U.findIndex(a=>a.id===r);return e.jsx("div",{className:"w-full py-6",children:e.jsx("div",{className:"flex items-center justify-between",children:U.map((a,t)=>{const n=t<s,i=t===s,o=t>s;return e.jsxs(de.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:I("w-10 h-10 rounded-full flex items-center justify-center text-sm font-semibold transition-all duration-300",n&&"bg-green-600 text-white",i&&"bg-accent text-white ring-4 ring-accent/20",o&&"bg-gray-200 text-gray-500"),children:n?e.jsx(ss,{className:"w-5 h-5"}):e.jsx("span",{children:t+1})}),e.jsxs("div",{className:"mt-2 text-center",children:[e.jsx("div",{className:I("text-sm font-medium",n&&"text-green-600",i&&"text-accent",o&&"text-gray-500"),children:a.label}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:a.description})]})]}),t<U.length-1&&e.jsx("div",{className:I("flex-1 h-0.5 mx-4 transition-all duration-300",t<s?"bg-green-600":"bg-gray-200")})]},a.id)})})})},qs=({unitName:r,checkIn:s,checkOut:a,guests:t,quote:n,className:i})=>{const o=new Date(s),u=new Date(a);return e.jsxs(v,{className:i,children:[e.jsx(A,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5 text-accent"}),"Booking Summary"]})}),e.jsxs(k,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:r}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsxs("span",{children:[B(o,"EEE, MMM d")," - ",B(u,"EEE, MMM d, yyyy")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsxs("span",{children:[n.nights," nights"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),e.jsxs("span",{children:[t," guest",t!==1?"s":""]})]})]})]}),e.jsx(re,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium",children:"Price Details"}),n.lineItems.map((m,f)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:m.label}),e.jsx("span",{className:"font-medium",children:_(m.amountCents,n.currency)})]},f)),e.jsx(re,{}),e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"text-accent",children:_(n.totalCents,n.currency)})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsxs("span",{children:["Free cancellation until ",n.refundableUntil?B(new Date(n.refundableUntil),"MMM d, h:mm a"):"48 hours before check-in"]})]}),e.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[e.jsx("h5",{className:"font-medium text-sm mb-1",children:"Check-in Information"}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Check-in: 3:00 PM - 10:00 PM",e.jsx("br",{}),"Check-out: 11:00 AM",e.jsx("br",{}),"Self check-in with keypad"]})]})]})]})]})},Hs=[{code:"GR",name:"Greece"},{code:"US",name:"United States"},{code:"GB",name:"United Kingdom"},{code:"DE",name:"Germany"},{code:"FR",name:"France"},{code:"IT",name:"Italy"},{code:"ES",name:"Spain"},{code:"NL",name:"Netherlands"},{code:"BE",name:"Belgium"},{code:"AT",name:"Austria"},{code:"CH",name:"Switzerland"},{code:"SE",name:"Sweden"},{code:"NO",name:"Norway"},{code:"DK",name:"Denmark"},{code:"FI",name:"Finland"},{code:"CA",name:"Canada"},{code:"AU",name:"Australia"},{code:"JP",name:"Japan"},{code:"OTHER",name:"Other"}],Us=({form:r,errors:s,onChange:a})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs(v,{children:[e.jsxs(A,{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5 text-accent"}),"Contact Information"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Your contact details for booking confirmation and communication."})]}),e.jsxs(k,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"firstName",className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"First Name *"]}),e.jsx(M,{id:"firstName",value:r.firstName,onChange:t=>a("firstName",t.target.value),className:s.firstName?"border-red-500 focus:border-red-500":"",placeholder:"Enter your first name",required:!0}),s.firstName&&e.jsx("p",{className:"text-sm text-red-600",children:s.firstName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"lastName",className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Last Name *"]}),e.jsx(M,{id:"lastName",value:r.lastName,onChange:t=>a("lastName",t.target.value),className:s.lastName?"border-red-500 focus:border-red-500":"",placeholder:"Enter your last name",required:!0}),s.lastName&&e.jsx("p",{className:"text-sm text-red-600",children:s.lastName})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"email",className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"Email Address *"]}),e.jsx(M,{id:"email",type:"email",value:r.email,onChange:t=>a("email",t.target.value),className:s.email?"border-red-500 focus:border-red-500":"",placeholder:"your.email@example.com",required:!0}),s.email&&e.jsx("p",{className:"text-sm text-red-600",children:s.email}),e.jsx("p",{className:"text-xs text-gray-500",children:"We'll send your booking confirmation and check-in instructions to this email."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"phone",className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),"Phone Number"]}),e.jsx(M,{id:"phone",type:"tel",value:r.phone,onChange:t=>a("phone",t.target.value),className:s.phone?"border-red-500 focus:border-red-500":"",placeholder:"+30 123 456 7890"}),s.phone&&e.jsx("p",{className:"text-sm text-red-600",children:s.phone}),e.jsx("p",{className:"text-xs text-gray-500",children:"Optional. We may contact you if needed regarding your stay."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"country",className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Country of Residence"]}),e.jsxs(as,{value:r.country,onValueChange:t=>a("country",t),children:[e.jsx(ts,{className:s.country?"border-red-500 focus:border-red-500":"",children:e.jsx(ns,{placeholder:"Select your country"})}),e.jsx(rs,{children:Hs.map(t=>e.jsx(is,{value:t.code,children:t.name},t.code))})]}),s.country&&e.jsx("p",{className:"text-sm text-red-600",children:s.country})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(E,{htmlFor:"specialRequests",className:"flex items-center gap-2",children:[e.jsx(os,{className:"h-4 w-4"}),"Special Requests"]}),e.jsx(cs,{id:"specialRequests",value:r.specialRequests,onChange:t=>a("specialRequests",t.target.value),placeholder:"Any special requests or requirements for your stay? (e.g., early check-in, late check-out, accessibility needs)",rows:3,className:"resize-none"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Optional. We'll do our best to accommodate your requests."})]})]})]}),e.jsx(v,{className:"bg-blue-50 border-blue-200",children:e.jsx(k,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx($,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Check-in Information"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Please bring a valid ID (passport or national ID card) for verification during check-in. The primary guest must be at least 18 years old."})]})]})})})]}),Vs=({bookingId:r,unitName:s,checkIn:a,checkOut:t,guests:n,customerName:i,customerEmail:o,totalAmount:u,currency:m,onBackToHome:f,onViewBooking:h,onDownloadConfirmation:c})=>{const x=new Date(a),p=new Date(t),y=Math.ceil((p.getTime()-x.getTime())/(1e3*60*60*24));return e.jsxs("div",{className:"space-y-6",children:[e.jsx(v,{className:"border-green-200 bg-green-50",children:e.jsxs(k,{className:"p-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"w-16 h-16 bg-green-600 rounded-full flex items-center justify-center",children:e.jsx(Q,{className:"w-8 h-8 text-white"})})}),e.jsx("h1",{className:"text-2xl font-bold text-green-800 mb-2",children:"Booking Confirmed!"}),e.jsx("p",{className:"text-green-700 mb-4",children:"Thank you for choosing Habitat Lobby. Your reservation has been successfully created."}),e.jsxs(me,{variant:"secondary",className:"bg-green-100 text-green-800 px-4 py-2",children:["Booking ID: ",r.slice(-8).toUpperCase()]})]})}),e.jsxs(v,{children:[e.jsx(A,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-accent"}),"Booking Details"]})}),e.jsx(k,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:s}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{children:"Trikala, Greece"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsxs("span",{children:[B(x,"EEE, MMM d")," - ",B(p,"EEE, MMM d, yyyy")]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsxs("span",{children:[y," night",y!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(z,{className:"h-4 w-4"}),e.jsxs("span",{children:[n," guest",n!==1?"s":""]})]})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Guest Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx("span",{children:i})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{children:o})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Total Amount"}),e.jsx("div",{className:"text-2xl font-bold text-accent",children:_(u*100,m)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Payment confirmed"})]})]})]})})]}),e.jsxs(v,{children:[e.jsx(A,{children:e.jsx(R,{children:"What's Next?"})}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(G,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Confirmation Email Sent"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["A detailed confirmation has been sent to ",o]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(Y,{className:"w-4 h-4 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Check-in Instructions"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Detailed check-in instructions will be sent 24 hours before your arrival"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(Cs,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"Access Codes"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Door codes and WiFi details will be provided 2 hours before check-in"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(ls,{className:"w-4 h-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"24/7 Support"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Our team is available around the clock during your stay"})]})]})]})})]}),e.jsx(v,{className:"bg-gray-50",children:e.jsxs(k,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Need Help?"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Contact Information"}),e.jsxs("div",{className:"space-y-1 text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{children:"hello@habitatlobby.com"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{children:"+30 243 123 4567"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Check-in Details"}),e.jsxs("div",{className:"space-y-1 text-gray-600",children:[e.jsx("p",{children:"Check-in: 3:00 PM - 10:00 PM"}),e.jsx("p",{children:"Check-out: 11:00 AM"}),e.jsx("p",{children:"Self check-in available"})]})]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(S,{onClick:h,className:"flex-1",children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"View & Manage Booking"]}),e.jsxs(S,{onClick:f,variant:"outline",className:"flex-1",children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Back to Home"]}),c&&e.jsxs(S,{onClick:c,variant:"outline",className:"flex-1",children:[e.jsx(xs,{className:"h-4 w-4 mr-2"}),"Download Confirmation"]})]})]})},Xs=()=>{const r=hs(),{unitSlug:s,dates:a,guests:t,quote:n,reset:i}=ps(),[o,u]=d.useState({firstName:"",lastName:"",email:"",phone:"",country:"",specialRequests:""}),[m,f]=d.useState(!1),[h,c]=d.useState(null),[x,p]=d.useState("details"),[y,w]=d.useState(""),[j,b]=d.useState({}),[P,D]=d.useState("");d.useEffect(()=>{console.log("ðŸ§ª CheckoutEnhanced: bookingEmailService loaded:",!!H),console.log("ðŸ§ª CheckoutEnhanced: bookingEmailService type:",typeof H),us("checkout"),s&&gs(s)},[s]),d.useEffect(()=>{(async()=>{if(s){console.log("Fetching property name for unitSlug:",s);try{const N=Ns.find(F=>F.slug===s);if(N){console.log("Found apartment by slug:",N.name),D(N.name);return}console.log("Not found in apartments data, fetching from Supabase...");const g=await V.getProperty(s);g?(console.log("Found property in Supabase:",g.name),D(g.name)):(console.log("Property not found, using fallback"),D(s))}catch(N){console.error("Error fetching property name:",N),D(s)}}})()},[s]);const Ae=(l,N)=>{u(g=>({...g,[l]:N})),j[l]&&b(g=>({...g,[l]:""}))},Re=d.useCallback(()=>{const l={};return o.firstName.trim()||(l.firstName="First name is required"),o.lastName.trim()||(l.lastName="Last name is required"),o.email.trim()?/\S+@\S+\.\S+/.test(o.email)||(l.email="Please enter a valid email address"):l.email="Email is required",b(l),Object.keys(l).length===0},[o]);if(!s||!n||!a.from||!a.to)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ie,{title:"Checkout - Habitat Lobby",description:"Complete your booking at Habitat Lobby",noindex:!0}),e.jsx("div",{className:"container py-10",children:e.jsx(v,{className:"max-w-md mx-auto",children:e.jsxs(k,{className:"p-6 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No booking in progress."}),e.jsxs(S,{onClick:()=>r(-1),variant:"outline",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Go Back"]})]})})})]});const _e=async l=>{l.preventDefault(),Re()&&await Ie()},Ie=async()=>{f(!0),b({});try{console.log("Starting checkout process...");const l=await vs.startCheckout({unitSlug:s,checkIn:a.from,checkOut:a.to,guests:t,customer:o});if(console.log("Checkout response:",l),!l.clientSecret)throw new Error("No client secret received from payment service");w(l.clientSecret),p("payment")}catch(l){console.error("Failed to create payment intent:",l);const N=l instanceof Error?l.message:"Failed to prepare payment. Please try again.";b({payment:N})}finally{f(!1)}},Be=async l=>{var N;try{console.log("Payment success! Payment intent:",l),console.log("Payment intent metadata:",l.metadata);let g=(N=l.metadata)==null?void 0:N.booking_id;if(!g){console.log("No booking_id in metadata, searching by payment_intent_id:",l.id);try{const{data:C,error:ae}=await O.from("bookings").select("id").eq("payment_intent_id",l.id).single();if(ae)throw console.error("Error finding booking by payment_intent_id:",ae),new Error("Could not find booking for this payment");g=C.id,console.log("Found booking by payment_intent_id:",g)}catch(C){throw console.error("Database error:",C),new Error("Could not find booking for this payment")}}if(!g)throw console.error("No booking_id found. Available metadata keys:",Object.keys(l.metadata||{})),new Error("No booking ID found in payment intent");if(g)try{await V.updateBookingStatus(g,"confirmed"),console.log("âœ… Booking confirmed:",g),console.log("ðŸ”„ Starting email notification process...");try{console.log("ðŸ”„ Attempting to send booking confirmation email for booking:",g),console.log("ðŸ“§ Calling bookingEmailService.sendBookingConfirmationById...");const C=await H.sendBookingConfirmationById(g);console.log("ðŸ“§ Email service result:",C),C?console.log("âœ… Booking confirmation email sent successfully!",{bookingId:g}):(console.error("âŒ Failed to send booking confirmation email"),console.log("ðŸ“§ Email will be retried later or sent manually"))}catch(C){console.error("ðŸ’¥ Email service error:",C),console.log("ðŸ“§ Email will be retried later or sent manually")}}catch(C){console.error("Failed to update booking status:",C)}const F=n!=null&&n.totalCents?n.totalCents/100:0;c({bookingId:g,customerName:`${o.firstName} ${o.lastName}`.trim(),customerEmail:o.email,totalAmount:F}),ks(g,F),p("confirmation")}catch(g){console.error("Error processing payment success:",g),b({payment:"Payment succeeded but there was an error processing your booking. Please contact support."})}},De=l=>{console.error("Payment failed:",l),b({payment:l||"Payment failed. Please try again."})};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ie,{title:"Checkout - Habitat Lobby",description:"Complete your booking at Habitat Lobby",noindex:!0}),e.jsxs("div",{className:"container py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"max-w-6xl mx-auto",children:e.jsx(Ls,{currentStep:x})})}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8 max-w-6xl mx-auto",children:[e.jsxs("div",{className:"lg:col-span-2",children:[x==="details"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(Us,{form:o,errors:j,onChange:Ae}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(S,{type:"button",variant:"outline",onClick:()=>r(-1),className:"flex-1",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsx(S,{type:"button",onClick:_e,className:"flex-1",size:"lg",children:"Continue to Add-ons"})]})]}),x==="payment"&&y&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(fs,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Secure payment powered by Stripe"})]}),e.jsx(ys,{stripe:js,options:{clientSecret:y,appearance:bs,locale:"en"},children:e.jsx(Ts,{amount:n.totalCents,currency:n.currency,bookingDetails:{unitName:P||"Property",checkIn:a.from,checkOut:a.to,guests:t,nights:n.nights},customerDetails:{name:`${o.firstName} ${o.lastName}`.trim(),email:o.email},onSuccess:Be,onError:De})})]}),x==="confirmation"&&h&&e.jsx(Vs,{bookingId:h.bookingId,unitName:P||"Property",checkIn:a.from,checkOut:a.to,guests:t,customerName:h.customerName,customerEmail:h.customerEmail,totalAmount:h.totalAmount,currency:n.currency,onViewBooking:()=>{i(),r(`/view-booking/${h.bookingId}`)},onBackToHome:()=>{i(),r("/")}})]}),e.jsx("div",{className:"lg:col-span-1",children:x!=="confirmation"&&e.jsx(qs,{unitName:P||"Property",checkIn:a.from,checkOut:a.to,guests:t,quote:n,className:"sticky top-8"})})]})]})]})};export{Xs as default};
